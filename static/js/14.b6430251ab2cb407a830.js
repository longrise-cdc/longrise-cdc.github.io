webpackJsonp([14],{LyAo:function(t,e){},MixG:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),n=a("2uFj"),l=a("mtWM"),o=a.n(l),r={name:"userList",head:{title:function(){return{inner:this.title}}},data:function(){var t=this;return{title:"项目管理",captcha:n.k,branch:n.j,projectCategory:n.G,loading:!1,currentPage:parseInt(this.$route.query.page)||1,tableLoading:!1,addDone:!1,slide:"邮箱",height:0,selection:"",currentData:{},total:0,modal:{add:!1,edit:!1,delete:!1},limit:{branch:"",category:"",title:""},between:[],search:{sort:"desc",limit:"",pagesize:15,page:this.$route.query.page||1,between:""},add:{uId:JSON.parse(this.$localStorage.get("userInfo")).uId,username:"",phone:"",email:"",captcha:""},edit:{uId:JSON.parse(this.$localStorage.get("userInfo")).uId,oId:"",userInfo:"",captcha:""},column:[{type:"selection",width:60,align:"center"},{title:"标题",key:"title",width:500},{title:"所属部门",key:"branch",align:"center",width:100,render:function(e,a){return t.list[a.index][a.column.key].name}},{title:"分类",key:"category",align:"center",width:100,render:function(e,a){return t.list[a.index][a.column.key].name}},{title:"作者",key:"author",align:"center",width:100,render:function(e,a){return t.list[a.index][a.column.key].name}},{title:"浏览量",align:"center",width:100,key:"view"},{title:"下载量",width:100,align:"center",key:"download"},{title:"注册时间",key:"created_at",align:"center",render:function(e,a){var i=t.list[a.index][a.column.key];return new Date(1e3*parseInt(i)).toLocaleString().replace(/:\d{1,2}$/," ")}},{title:"操作",key:"action",align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"5px"},on:{click:function(){console.log(a.index)}}},"查看"),e("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.modal.edit=!0,t.currentData=t.list[a.index],t.oId=t.list[a.index].uId}}},"编辑"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.selection="",t.modal.delete=!0,t.selection=t.list[a.index].uId}}},"删除")])}}],list:[]}},mounted:function(){this.height=this.$refs.main.offsetHeight},created:function(){this.getList()},methods:{delSubmit:function(){var t=this;console.log(this.selection),o()({method:"get",url:n.K,params:{uId:this.selection,author:JSON.parse(this.$localStorage.get("userInfo")).uId}}).then(function(e){e.data.status?(t.$Message.success(e.data.msg),t.getcaptcha(),t.modal.delete=!1,t.getList()):t.$Message.error(e.data.msg)})},onSelected:function(t){var e=this;this.selection=[],t.forEach(function(t,a){e.selection+=t.uId+","}),this.selection=this.selection.substr(0,this.selection.length-1)},dateChange:function(t){this.currentData.birthday=new Date(t).valueOf()/1e3},editSubmit:function(){var t=this;this.edit.oId=this.currentData.uId,console.log(this.edit,this.currentData),this.edit.userInfo=s()(this.currentData),this.loading=!this.loading,o()({method:"get",url:n.g,params:this.edit}).then(function(e){t.loading=!t.loading,e.data.status?(t.$Message.success(e.data.msg),t.getcaptcha(),t.modal.edit=!1,t.getList()):t.$Message.error(e.data.msg)})},pageChange:function(t){console.log(t),this.$router.push("/admin/project?page="+t),this.search.page=t,this.getList()},getcaptcha:function(){this.captcha=this.captcha+"?"+new Date},addReset:function(){this.add={uId:JSON.parse(this.$localStorage.get("userInfo")).uId,username:"",phone:"",email:"",captcha:""},this.addDone=!1},addSubmit:function(){var t=this;this.loading=!this.loading,o()({method:"get",url:n.f,params:this.add}).then(function(e){t.loading=!t.loading,e.data.status?(t.$Message.success(e.data.msg),t.addDone=!0,t.addReset(),t.getcaptcha(),t.getList()):t.$Message.error(e.data.msg)})},getList:function(){var t=this;this.tableLoading=!0,o()({method:"get",url:n.I,params:this.search}).then(function(e){e.data.status&&(console.log(e.data.data),t.total=e.data.data.total,t.list=e.data.data.data,t.tableLoading=!1)})},_search:function(){for(var t in this.limit)""!==this.limit[t]&&"null"!==this.limit[t]||delete this.limit[t];if(this.search.page=1,this.currentPage=1,this.$router.replace("/admin/project?page="+this.currentPage),this.search.limit=s()(this.limit),this.between.length){var e=this.between[0],a=this.between[1];this.search.between={start:Date.parse(new Date(e))/1e3,end:Date.parse(new Date(a))/1e3},this.search.between=s()(this.search.between)}this.getList()},jump:function(t){this.$router.push(t)}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-view"},[a("div",{staticClass:"page-title"},[a("ul",{staticClass:"row w h"},[a("li",{staticClass:"col v-m g-4"},[t._v("项目管理")]),t._v(" "),a("li",{staticClass:"col v-m t-r"},[a("Poptip",{attrs:{placement:"bottom-start",width:"450"}},[a("Button",{attrs:{icon:"funnel",type:"text"}},[t._v("更多条件")]),t._v(" "),a("ul",{staticClass:"form more",attrs:{slot:"content"},slot:"content"},[a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-5"},[t._v("项目组：")]),t._v(" "),a("li",{staticClass:"col v-m g-19 t-l"},[a("Select",{model:{value:t.limit.branch,callback:function(e){t.$set(t.limit,"branch",e)},expression:"limit.branch"}},t._l(t.branch,function(e){return a("Option",{key:e.value,attrs:{value:e.label}},[t._v(t._s(e.label))])}))],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-5"},[t._v("分类：")]),t._v(" "),a("li",{staticClass:"col v-m g-19 t-l"},[a("Select",{model:{value:t.limit.category,callback:function(e){t.$set(t.limit,"category",e)},expression:"limit.category"}},t._l(t.projectCategory,function(e){return a("Option",{key:e.value,attrs:{value:e.label}},[t._v(t._s(e.label))])}))],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-5"},[t._v("发布时间：")]),t._v(" "),a("li",{staticClass:"col v-m g-19 t-l"},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange",placeholder:"选择发布时间"},model:{value:t.between,callback:function(e){t.between=e},expression:"between"}})],1)])])])],1),t._v(" "),a("div",{staticClass:"search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入项目名称！"},model:{value:t.limit.title,callback:function(e){t.$set(t.limit,"title",e)},expression:"limit.title"}}),t._v(" "),a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t._search}})],1),t._v(" "),a("Button",{attrs:{type:"ghost"},on:{click:function(e){t.jump("/admin/project/publish")}}},[t._v("发布项目")]),t._v(" "),t.selection.split(",").length>1?a("Button",{attrs:{type:"error"},on:{click:function(e){t.modal.delete=!t.modal.delete}}},[t._v("批量删除")]):t._e()],1)])]),t._v(" "),a("div",{staticClass:"admin-main"},[a("div",{ref:"main",staticClass:"w h"},[a("Table",{ref:"selection",attrs:{border:"",columns:t.column,data:t.list,height:t.height,loading:t.tableLoading},on:{"on-selection-change":t.onSelected}})],1)]),t._v(" "),a("div",{staticClass:"page-area row"},[a("div",{staticClass:"col v-m"},[t._v("\n      每页"),a("span",[t._v(t._s(t.search.pagesize))]),t._v("条/\n      总数："),a("span",[t._v(t._s(t.total))]),t._v("条\n    ")]),t._v(" "),a("div",{staticClass:"col v-m t-r"},[a("Page",{attrs:{current:t.currentPage,"page-size":t.search.pagesize,size:"small",total:t.total,"show-elevator":""},on:{"on-change":t.pageChange}})],1)]),t._v(" "),a("Modal",{attrs:{title:"发布项目",width:"1200px","mask-closable":!1},model:{value:t.modal.add,callback:function(e){t.$set(t.modal,"add",e)},expression:"modal.add"}},[a("div",{staticClass:"t-r",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){t.modal.add=!1}}},[t._v("取消")]),t._v(" "),t.addDone?t._e():a("Button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:t.addSubmit}},[t._v("确认添加")]),t._v(" "),t.addDone?a("Button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:t.addReset}},[t._v("继续添加")]):t._e()],1)]),t._v(" "),a("Modal",{attrs:{title:"编辑用户","mask-closable":!1},model:{value:t.modal.edit,callback:function(e){t.$set(t.modal,"edit",e)},expression:"modal.edit"}},[a("div",{staticClass:"t-r",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){t.modal.edit=!1}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:t.editSubmit}},[t._v("确认添加")])],1)]),t._v(" "),a("Modal",{attrs:{title:"确认删除",loading:!0},on:{"on-ok":t.delSubmit},model:{value:t.modal.delete,callback:function(e){t.$set(t.modal,"delete",e)},expression:"modal.delete"}},[a("p",[t._v("确认要删除该"),a("span",{staticStyle:{color:"#f00",margin:"0 5px","font-size":"16px"}},[t._v("("+t._s(t.selection.split(",").length)+")")]),t._v("条记录？")])])],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(t){a("LyAo")},null,null);e.default=d.exports}});
//# sourceMappingURL=14.b6430251ab2cb407a830.js.map