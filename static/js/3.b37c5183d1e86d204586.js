webpackJsonp([3],{DmRq:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("2uFj"),n=e("mtWM"),a=e.n(n),l=e("7+uW"),o={name:"lil-context-menu",data:function(){return{x:null,y:null,userData:null}},computed:{style:function(){return this.isVisible?{top:this.y-document.body.scrollTop+"px",left:this.x+"px"}:{}},isVisible:function(){return null!==this.x&&null!==this.y}},methods:{open:function(t,i){var e=this;this.x=t.pageX||t.clientX,this.y=t.pageY||t.clientY,this.userData=i,l.default.nextTick(function(){return e.$el.focus()})},close:function(t){this.x=null,this.y=null,this.userData=null}}},c={render:function(){var t=this,i=t.$createElement;return(t._self._c||i)("div",{directives:[{name:"show",rawName:"v-show",value:t.isVisible,expression:"isVisible"}],staticClass:"lil-context-menu",style:t.style,attrs:{tabindex:"-1"},on:{blur:t.close,click:t.close,"!contextmenu":function(t){t.preventDefault()}}},[t._t("default",null,{userData:t.userData})],2)},staticRenderFns:[]};var r=e("VU/8")(o,c,!1,function(t){e("QbaO")},"data-v-fa8eb1a8",null).exports,u=e("KgXo"),d=e("KeBu"),p={name:"pan",head:{title:function(){return{inner:this.title}}},data:function(){return{title:"网盘",parent:"",grid:!0,foldname:"",list:{directions:0,files:0},loading:!1,uploadmodal:!1,updir:s.R,download:s.t,downurl:"",uploadlist:[],current:""}},components:{"context-menu":r,Loading:u.a,empty:d.a},created:function(){this.getDir(),this.current=this.$route.query.dir},methods:{back:function(){window.history.go(-1)},upchange:function(t,i){this.uploadlist=i},uploadFiles:function(t){var i=this,e=this.$route.query.dir;e?((e=e.split("/")).shift(),this.parent=e.join("/")):e="";var n=new FormData;n.append("file",t.file),n.append("dir",e),a()({method:"post",url:s.R,data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"},onUploadProgress:function(e){i.uploadlist.forEach(function(s,n){s.uid===t.file.uid&&(i.uploadlist[n].percentage=parseInt(e.loaded/e.total*100),100===i.uploadlist[n].percentage&&(i.uploadlist[n].status="uploadSuccess"),console.log(i.uploadlist[n].percentage))})}}).then(function(t){console.log(t),i.getDir()})},getDir:function(){var t=this;this.loading=!this.loading;var i={},e=this.$route.query.dir;this.current=e,e&&((e=e.split("/")).shift(),i={dir:e=e.join("/")}),a()({method:"get",url:s.C,params:i}).then(function(i){t.list=i.data.data,console.log(t.list),t.loading=!t.loading})},toggleGrid:function(){this.grid=!this.grid},onClick:function(t,i){switch(i){case"delete":this.delete(t);break;case"rename":this.rename(t);break;case"download":this.downfile(t)}},downfile:function(t){var i=t.dir.split("/");i.shift(),i=i.join("\\");var e=t.name.split(".");e.pop(),e=e.join(""),this.downurl=this.download+"?url="+i+"&name="+e,console.log(i)},rename:function(t){var i=this;this.$prompt("您正在重命名（"+t.name+"）！","重命名",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){var n=e.value,l=t.dir.split("/");l.shift(),l[l.length-1]=n,l=l.join("/");var o=t.dir.split("/");o.shift(),o=o.join("/"),console.log(l,o),a()({method:"get",url:s.Q,params:{dir:o,value:l}}).then(function(t){i.getDir()})}).catch(function(){i.$message({type:"info",message:"取消输入"})})},delete:function(t){var i=this;this.$confirm("此操作将永久删除该文件, 是否继续?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a()({method:"get",url:s.q,params:{dir:t.dir}}).then(function(t){i.getDir()})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},jump:function(t){t.url||this.$router.push("/pan?dir="+t.dir)},makeFolder:function(){var t=this,i=this.$route.query.dir;i?((i=i.split("/")).shift(),this.parent=i.join("/")):this.parent="",console.log(this.parent),this.$prompt("请填写目录名称！","创建目录",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(i){var e=i.value;a()({method:"get",url:s.A,params:{dir:e,parent:t.parent}}).then(function(i){t.getDir()})}).catch(function(){})}},watch:{$route:"getDir"}},v={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"pan"},[e("div",{staticClass:"bar"},[e("ul",{staticClass:"row w h"},[e("li",{staticClass:"col v-m"},[e("Button",{attrs:{type:"primary"},on:{click:function(i){t.uploadmodal=!0}}},[t._v("文件上传")]),t._v(" "),e("Button",{attrs:{type:"ghost"},on:{click:t.makeFolder}},[t._v("新建文件夹")]),t._v(" "),t.current?e("Button",{attrs:{type:"ghost"},on:{click:t.back}},[t._v("返回上一层")]):t._e()],1),t._v(" "),e("li",{staticClass:"col v-m"}),t._v(" "),e("li",{staticClass:"col v-m t-r grid"},[e("span",[t._v("文件夹："+t._s(t.list.directions))]),t._v(" "),e("span",[t._v("文件："+t._s(t.list.files))]),t._v(" "),e("span",{staticClass:"iconfont",class:{"icon-listgrid":!t.grid,"icon-list":t.grid},on:{click:t.toggleGrid}})])])]),t._v(" "),t.grid?t._e():e("ul",{staticClass:"grid dir-title"},[e("li",{staticClass:"grid-item",staticStyle:{width:"75%"}},[t._v("文件名")]),t._v(" "),e("li",{staticClass:"grid-item",staticStyle:{width:"10%"}},[t._v("大小")]),t._v(" "),e("li",{staticClass:"grid-item t-r",staticStyle:{width:"15%"}},[t._v("修改日期")])]),t._v(" "),t.loading?e("loading",{staticStyle:{height:"600px"},attrs:{name:"tail-spin",size:28}},[e("span",{attrs:{slot:"text"},slot:"text"},[t._v("正在努力加载，请稍后！")])]):t._e(),t._v(" "),t.loading||t.list.content.length?t._e():e("empty",{staticStyle:{height:"600px"},attrs:{name:"tail-spin",size:28}},[e("img",{attrs:{slot:"icon",src:"static/tip2.png",alt:""},slot:"icon"}),t._v(" "),e("span",{attrs:{slot:"text"},slot:"text"},[t._v("这里还空空如也！")])]),t._v(" "),t.loading?t._e():e("ul",{staticClass:"dir-list",class:{grid:t.grid}},[t._l(t.list.content,function(i,s){return t.grid?t._e():e("li",{key:s},[e("div",{staticClass:"dir-item",on:{click:function(e){t.jump(i)},contextmenu:function(e){e.preventDefault(),t.$refs.menu.open(e,i)}}},[i.url&&i.ext.indexOf("image")>-1?e("div",{staticClass:"icon"},[e("img",{attrs:{src:i.url,alt:""}})]):e("div",{staticClass:"icon"},[e("img",{attrs:{src:i.icon,alt:""}})]),t._v(" "),e("div",{staticClass:"name"},[t._v(t._s(i.name))]),t._v(" "),e("div",{staticClass:"size"},[t._v(t._s(i.size||"-"))]),t._v(" "),e("div",{staticClass:"time"},[t._v(t._s(new Date(1e3*parseInt(i.lasttime)).toLocaleString().replace(/:\d{1,2}$/," ")))])])])}),t._v(" "),t._l(t.list.content,function(i,s){return t.grid?e("li",{key:s},[e("Poptip",{attrs:{trigger:"hover",title:"文件信息",placement:"bottom-end"}},[e("span",{staticClass:"iconfont icon-info"}),t._v(" "),e("div",{attrs:{slot:"content"},slot:"content"},[e("p",[t._v("文件名称："+t._s(i.name))]),t._v(" "),e("p",[t._v("文件大小："+t._s(i.size||"-"))]),t._v(" "),e("p",[t._v("修改时间："+t._s(new Date(1e3*parseInt(i.lasttime)).toLocaleString().replace(/:\d{1,2}$/," ")))])])]),t._v(" "),e("div",{staticClass:"dir-item",on:{click:function(e){t.jump(i)},contextmenu:function(e){e.preventDefault(),t.$refs.menu.open(e,i)}}},[i.url&&"image/jpeg"===i.ext||"image/png"===i.ext?e("div",{staticClass:"icon"},[e("img",{attrs:{src:i.url,alt:""}})]):e("div",{staticClass:"icon"},[e("img",{attrs:{src:i.icon,alt:""}})]),t._v(" "),e("div",{staticClass:"name"},[t._v(t._s(i.name))]),t._v(" "),e("div",{staticClass:"size"},[t._v(t._s(i.size||"-"))]),t._v(" "),e("div",{staticClass:"time"},[t._v(t._s(new Date(1e3*parseInt(i.lasttime)).toLocaleString().replace(/:\d{1,2}$/," ")))])])],1):t._e()})],2),t._v(" "),e("context-menu",{ref:"menu"},[e("ul",{staticClass:"options",attrs:{"user-data":1}},[e("li",{on:{click:function(i){t.onClick(t.$refs.menu.userData,"rename")}}},[e("span",{staticClass:"v-m iconfont icon-rename"}),e("span",{staticClass:"v-m"},[t._v("重命名")])]),t._v(" "),e("li",{on:{click:function(i){t.onClick(t.$refs.menu.userData,"share")}}},[e("span",{staticClass:"v-m iconfont icon-share"}),e("span",{staticClass:"v-m"},[t._v("分享")])]),t._v(" "),e("li",{on:{click:function(i){t.onClick(t.$refs.menu.userData,"move")}}},[e("span",{staticClass:"v-m iconfont icon-move"}),e("span",{staticClass:"v-m"},[t._v("移动到")])]),t._v(" "),e("li",{on:{click:function(i){t.onClick(t.$refs.menu.userData,"delete")}}},[e("span",{staticClass:"v-m iconfont icon-del"}),e("span",{staticClass:"v-m"},[t._v("删除")])]),t._v(" "),e("li",{on:{click:function(i){t.onClick(t.$refs.menu.userData,"download")}}},[e("span",{staticClass:"v-m iconfont icon-download"}),e("span",{staticClass:"v-m"},[t._v("下载")])])])]),t._v(" "),e("el-dialog",{attrs:{title:"文件上传",visible:t.uploadmodal,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(i){t.uploadmodal=i}}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:t.updir,"show-file-list":!1,"http-request":t.uploadFiles,"auto-upload":!0,"file-list":t.uploadlist,"on-change":t.upchange,multiple:""}},[e("i",{staticClass:"el-icon-upload"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),e("em",[t._v("点击上传")])]),t._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])]),t._v(" "),e("el-form",t._l(t.uploadlist,function(t,i){return e("el-form-item",{key:i,attrs:{label:t.name}},[e("el-progress",{attrs:{percentage:t.percentage,status:"uploadSuccess"===t.status?"success":""}})],1)})),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(i){t.uploadmodal=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(i){t.uploadmodal=!1}}},[t._v("完成")])],1)],1),t._v(" "),e("iframe",{attrs:{src:t.downurl,frameborder:"0"}})],1)},staticRenderFns:[]};var m=e("VU/8")(p,v,!1,function(t){e("wTQ3")},"data-v-c0de2070",null);i.default=m.exports},QbaO:function(t,i){},wTQ3:function(t,i){}});
//# sourceMappingURL=3.b37c5183d1e86d204586.js.map