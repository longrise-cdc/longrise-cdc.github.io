webpackJsonp([4],{AmHV:function(t,e,a){"use strict";var s={filterSex:function(t){switch(t){case 2:return"私密";case 0:return"男";case 1:return"女"}},delObj:function(t,e){return e.forEach(function(e,a){delete t[e]}),t},requestFullScreen:function(){var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},renderTheme:function(t){return""}};e.a=s},bi2j:function(t,e){},cgTB:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),l=a.n(s),i=a("2uFj"),c=a("AmHV"),o=a("mtWM"),n=a.n(o),r={name:"userList",head:{title:function(){return{inner:this.title}}},data:function(){var t=this;return{title:"用户管理",captcha:i.k,loading:!1,currentPage:parseInt(this.$route.query.page)||1,tableLoading:!1,addDone:!1,slide:"邮箱",height:0,selection:"",currentData:{},total:0,modal:{add:!1,edit:!1,delete:!1},limit:{sex:"null",name:""},between:[],search:{sort:"desc",limit:"",pagesize:15,page:this.$route.query.page||1,between:""},add:{uId:JSON.parse(this.$localStorage.get("userInfo")).uId,username:"",phone:"",email:"",captcha:""},edit:{uId:JSON.parse(this.$localStorage.get("userInfo")).uId,oId:"",userInfo:"",captcha:""},column:[{type:"selection",width:60,align:"center"},{title:"姓名",key:"name"},{title:"用户名",key:"username"},{title:"性别",key:"sex",render:function(e,a){var s=t.list[a.index][a.column.key];return c.a.filterSex(s)}},{title:"邮箱",key:"email"},{title:"手机",key:"phone"},{title:"生日",key:"birthday",render:function(e,a){var s=t.list[a.index][a.column.key];if(s)return new Date(1e3*parseInt(s)).toLocaleString().replace(/:\d{1,2}$/," ")}},{title:"微信",key:"wechat"},{title:"注册时间",key:"created_at",render:function(e,a){var s=t.list[a.index][a.column.key];return new Date(1e3*parseInt(s)).toLocaleString().replace(/:\d{1,2}$/," ")}},{title:"操作",key:"action",align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"5px"},on:{click:function(){console.log(a.index)}}},"查看"),e("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.modal.edit=!0,t.currentData=t.list[a.index],t.oId=t.list[a.index].uId}}},"编辑"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.selection="",t.modal.delete=!0,t.selection=t.list[a.index].uId}}},"删除")])}}],list:[]}},mounted:function(){this.height=this.$refs.main.offsetHeight},created:function(){this.getList()},methods:{delSubmit:function(){var t=this;console.log(this.selection),n()({method:"get",url:i.F,params:{uId:this.selection,author:JSON.parse(this.$localStorage.get("userInfo")).uId}}).then(function(e){e.data.status?(t.$Message.success(e.data.msg),t.getcaptcha(),t.modal.delete=!1,t.getList()):t.$Message.error(e.data.msg)})},onSelected:function(t){var e=this;this.selection=[],t.forEach(function(t,a){e.selection+=t.uId+","}),this.selection=this.selection.substr(0,this.selection.length-1)},dateChange:function(t){this.currentData.birthday=new Date(t).valueOf()/1e3},editSubmit:function(){var t=this;this.edit.oId=this.currentData.uId,console.log(this.edit,this.currentData),this.edit.userInfo=l()(this.currentData),this.loading=!this.loading,n()({method:"get",url:i.g,params:this.edit}).then(function(e){t.loading=!t.loading,e.data.status?(t.$Message.success(e.data.msg),t.getcaptcha(),t.modal.edit=!1,t.getList()):t.$Message.error(e.data.msg)})},pageChange:function(t){console.log(t),this.$router.push("/admin/user?page="+t),this.search.page=t,this.getList()},getcaptcha:function(){this.captcha=this.captcha+"?"+new Date},addReset:function(){this.add={uId:JSON.parse(this.$localStorage.get("userInfo")).uId,username:"",phone:"",email:"",captcha:""},this.addDone=!1},addSubmit:function(){var t=this;this.loading=!this.loading,n()({method:"get",url:i.f,params:this.add}).then(function(e){t.loading=!t.loading,e.data.status?(t.$Message.success(e.data.msg),t.addDone=!0,t.addReset(),t.getcaptcha(),t.getList()):t.$Message.error(e.data.msg)})},getList:function(){var t=this;this.tableLoading=!0,n()({method:"get",url:i.N,params:this.search}).then(function(e){e.data.status&&(console.log(e.data.data),t.total=e.data.data.total,t.list=e.data.data.data,t.tableLoading=!1)})},_search:function(){for(var t in this.limit)""!==this.limit[t]&&"null"!==this.limit[t]||delete this.limit[t];if(this.search.page=1,this.currentPage=1,this.$router.replace("/admin/user?page="+this.currentPage),this.search.limit=l()(this.limit),this.between.length){var e=this.between[0],a=this.between[1];this.search.between={start:Date.parse(new Date(e))/1e3,end:Date.parse(new Date(a))/1e3},this.search.between=l()(this.search.between)}console.log(this.search),console.log(this.between),this.getList()}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-view"},[a("div",{staticClass:"page-title"},[a("ul",{staticClass:"row w h"},[a("li",{staticClass:"col v-m g-4"},[t._v("用户管理")]),t._v(" "),a("li",{staticClass:"col v-m t-r"},[a("Poptip",{attrs:{placement:"bottom-start",width:"450"}},[a("Button",{attrs:{icon:"funnel",type:"text"}},[t._v("更多条件")]),t._v(" "),a("ul",{staticClass:"form more",attrs:{slot:"content"},slot:"content"},[a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-5"},[t._v("性别：")]),t._v(" "),a("li",{staticClass:"col v-m g-19 t-l"},[a("RadioGroup",{model:{value:t.limit.sex,callback:function(e){t.$set(t.limit,"sex",e)},expression:"limit.sex"}},[a("Radio",{attrs:{label:0}},[t._v("男")]),t._v(" "),a("Radio",{attrs:{label:1}},[t._v("女")]),t._v(" "),a("Radio",{attrs:{label:2}},[t._v("隐私")]),t._v(" "),a("Radio",{attrs:{label:"null"}},[t._v("不限")])],1)],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-5"},[t._v("注册时间：")]),t._v(" "),a("li",{staticClass:"col v-m g-19 t-l"},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange",placeholder:"Select date"},model:{value:t.between,callback:function(e){t.between=e},expression:"between"}})],1)])])])],1),t._v(" "),a("div",{staticClass:"search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入用户姓名！"},model:{value:t.limit.name,callback:function(e){t.$set(t.limit,"name",e)},expression:"limit.name"}}),t._v(" "),a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t._search}})],1),t._v(" "),a("Button",{attrs:{type:"ghost"},on:{click:function(e){t.modal.add=!t.modal.add}}},[t._v("添加用户")]),t._v(" "),t.selection.split(",").length>1?a("Button",{attrs:{type:"error"},on:{click:function(e){t.modal.delete=!t.modal.delete}}},[t._v("批量删除")]):t._e()],1)])]),t._v(" "),a("div",{staticClass:"admin-main"},[a("div",{ref:"main",staticClass:"w h"},[a("Table",{ref:"selection",attrs:{border:"",columns:t.column,data:t.list,height:t.height,loading:t.tableLoading},on:{"on-selection-change":t.onSelected}})],1)]),t._v(" "),a("div",{staticClass:"page-area row"},[a("div",{staticClass:"col v-m"},[t._v("\n      每页"),a("span",[t._v(t._s(t.search.pagesize))]),t._v("条/\n      总数："),a("span",[t._v(t._s(t.total))]),t._v("条\n    ")]),t._v(" "),a("div",{staticClass:"col v-m t-r"},[a("Page",{attrs:{current:t.currentPage,"page-size":t.search.pagesize,size:"small",total:t.total,"show-elevator":""},on:{"on-change":t.pageChange}})],1)]),t._v(" "),a("Modal",{attrs:{title:"新增用户","mask-closable":!1},model:{value:t.modal.add,callback:function(e){t.$set(t.modal,"add",e)},expression:"modal.add"}},[a("div",{staticClass:"t-c"},[a("RadioGroup",{attrs:{type:"button"},model:{value:t.slide,callback:function(e){t.slide=e},expression:"slide"}},[a("Radio",{attrs:{label:"邮箱"}}),t._v(" "),a("Radio",{attrs:{label:"手机"}})],1)],1),t._v(" "),a("ul",{staticClass:"form",staticStyle:{width:"90%","margin-top":"20px"}},[a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("用户名：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"用户名"},model:{value:t.add.username,callback:function(e){t.$set(t.add,"username",e)},expression:"add.username"}})],1)])]),t._v(" "),"邮箱"===t.slide?a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("邮箱：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"邮箱"},model:{value:t.add.email,callback:function(e){t.$set(t.add,"email",e)},expression:"add.email"}})],1)])]):t._e(),t._v(" "),"手机"===t.slide?a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("手机号：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"手机号码"},model:{value:t.add.phone,callback:function(e){t.$set(t.add,"phone",e)},expression:"add.phone"}})],1)])]):t._e(),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("验证码：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"验证码"},model:{value:t.add.captcha,callback:function(e){t.$set(t.add,"captcha",e)},expression:"add.captcha"}})],1),t._v(" "),a("li",{staticClass:"col v-m"},[a("img",{staticClass:"v-m captcha",staticStyle:{"margin-left":"10px"},attrs:{src:t.captcha,alt:""},on:{click:t.getcaptcha}})])])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"}),t._v(" "),a("li",{staticClass:"col v-m"},["手机"===t.slide?a("p",{staticClass:"tip",staticStyle:{color:"#D84447"}},[t._v("密码默认是手机号码后6位。")]):t._e(),t._v(" "),"邮箱"===t.slide?a("p",{staticClass:"tip",staticStyle:{color:"#D84447"}},[t._v("随机生成6位数字密码，并发送到以上邮箱！")]):t._e()])])])]),t._v(" "),a("div",{staticClass:"t-r",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){t.modal.add=!1}}},[t._v("取消")]),t._v(" "),t.addDone?t._e():a("Button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:t.addSubmit}},[t._v("确认添加")]),t._v(" "),t.addDone?a("Button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:t.addReset}},[t._v("继续添加")]):t._e()],1)]),t._v(" "),a("Modal",{attrs:{title:"编辑用户","mask-closable":!1},model:{value:t.modal.edit,callback:function(e){t.$set(t.modal,"edit",e)},expression:"modal.edit"}},[a("ul",{staticClass:"form",staticStyle:{width:"90%","margin-top":"20px"}},[a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("用户名：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"用户名"},model:{value:t.currentData.username,callback:function(e){t.$set(t.currentData,"username",e)},expression:"currentData.username"}})],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("姓名：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"姓名"},model:{value:t.currentData.name,callback:function(e){t.$set(t.currentData,"name",e)},expression:"currentData.name"}})],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("性别：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("RadioGroup",{model:{value:t.currentData.sex,callback:function(e){t.$set(t.currentData,"sex",e)},expression:"currentData.sex"}},[a("Radio",{attrs:{label:0}},[t._v("男")]),t._v(" "),a("Radio",{attrs:{label:1}},[t._v("女")]),t._v(" "),a("Radio",{attrs:{label:2}},[t._v("私密")])],1)],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("生日：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{format:"yyyy/MM/dd",type:"date",placeholder:"选择出生日期"},on:{"on-change":t.dateChange},model:{value:t.currentData.birthday,callback:function(e){t.$set(t.currentData,"birthday",e)},expression:"currentData.birthday"}})],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("邮箱：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"邮箱"},model:{value:t.currentData.email,callback:function(e){t.$set(t.currentData,"email",e)},expression:"currentData.email"}})],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("手机号：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"手机号码"},model:{value:t.currentData.phone,callback:function(e){t.$set(t.currentData,"phone",e)},expression:"currentData.phone"}})],1)])]),t._v(" "),a("li",{staticClass:"form-item"},[a("ul",{staticClass:"row w"},[a("li",{staticClass:"col v-m g-3"},[t._v("验证码：")]),t._v(" "),a("li",{staticClass:"col v-m"},[a("Input",{attrs:{size:"large",placeholder:"验证码"},model:{value:t.edit.captcha,callback:function(e){t.$set(t.edit,"captcha",e)},expression:"edit.captcha"}})],1),t._v(" "),a("li",{staticClass:"col v-m"},[a("img",{staticClass:"v-m captcha",staticStyle:{"margin-left":"10px"},attrs:{src:t.captcha,alt:""},on:{click:t.getcaptcha}})])])])]),t._v(" "),a("div",{staticClass:"t-r",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(e){t.modal.edit=!1}}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:t.editSubmit}},[t._v("确认添加")])],1)]),t._v(" "),a("Modal",{attrs:{title:"确认删除",loading:!0},on:{"on-ok":t.delSubmit},model:{value:t.modal.delete,callback:function(e){t.$set(t.modal,"delete",e)},expression:"modal.delete"}},[a("p",[t._v("确认要删除该"),a("span",{staticStyle:{color:"#f00",margin:"0 5px","font-size":"16px"}},[t._v("("+t._s(t.selection.split(",").length)+")")]),t._v("条记录？")])])],1)},staticRenderFns:[]};var u=a("VU/8")(r,d,!1,function(t){a("bi2j")},null,null);e.default=u.exports}});
//# sourceMappingURL=4.ace7a5af3e4dcc6c2f3f.js.map