webpackJsonp([7],{W7VF:function(t,e){},sT3T:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("2uFj"),s=a("mtWM"),o=a.n(s),r=a("KeBu"),i=a("PJh5"),l=a.n(i),c=a("162o"),m={name:"projectInfo",head:{title:function(){return{inner:this.title}}},data:function(){return{title:"文章详情",info:null,comments:[],file:n.x,total:0,downUrl:"",pagesize:100,userInfo:JSON.parse(this.$localStorage.get("userInfo")),defaultProps:{children:"children",label:"content"},route:this.$route,reply:{content:"",topicId:this.$route.params.uId,topicType:0,parentId:"",fromId:"",toId:""},rebacker:{}}},components:{Empty:r.a},created:function(){this.userInfo&&(this.reply.fromId=this.userInfo.uId),this.getInfo()},methods:{addCollection:function(){var t=this;o()({methods:"get",url:n.l,params:{target:this.$route.params.uId,user:this.userInfo.uId}}).then(function(e){e.data.status&&(1===e.data.status?t.info.collection=1:2===e.data.status&&(t.info.collection=0),t.getInfo())})},gettime:function(t){return l()(1e3*parseInt(t)).calendar()},reback:function(t){this.reply.parentId=t.uId,this.reply.toId=t.fromId,this.rebacker=t,this.reply.fromId=JSON.parse(this.$localStorage.get("userInfo")).uId},rebacks:function(t,e){this.reply.parentId=t.uId,this.reply.toId=e.fromId,this.rebacker=e,this.reply.fromId=JSON.parse(this.$localStorage.get("userInfo")).uId},submit:function(){var t=this;if(!this.reply.content||this.reply.content.length<6)return this.$message.error("评论内容必须长于6位字符！"),!1;console.log(this.reply),o()({method:"get",url:n.m,params:this.reply}).then(function(e){console.log(e),t.reply.content="",t.getComments()})},down:function(t){var e=this;console.log(t),this.downUrl=n.u+"?url="+t.name+"&name="+this.info.title+"&uId="+this.info.uId,Object(c.setTimeout)(function(){e.getInfo()},1e3)},getInfo:function(){var t=this;this.reply.topicId=this.$route.params.uId,o()({method:"get",url:n.H,params:{uId:this.$route.params.uId,vistor:this.userInfo.uId}}).then(function(e){t.info=e.data.data,console.log(t.info);var a=t.info.attach.split("-");a.forEach(function(t,e){a[e]=JSON.parse(t)}),t.info.attach=a,t.title=e.data.data.title,t.$emit("updateHead"),t.getComments()})},getComments:function(){var t=this;this.total=0,this.comments=[],o()({method:"get",url:n.n,params:{topicId:this.$route.params.uId,pagesize:this.pagesize}}).then(function(e){t.total=e.data.total,t.comments=e.data.data.data})},setThumbs:function(){var t=this;o()({methods:"get",url:n.E,params:{target:this.$route.params.uId,user:this.userInfo.uId}}).then(function(e){e.data.status&&(1===e.data.status?t.info.praise=1:2===e.data.status&&(t.info.praise=0),t.getInfo())})}},watch:{$route:"getInfo"}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail"},[a("iframe",{staticStyle:{height:"0"},attrs:{src:t.downUrl,frameborder:"0"}}),t._v(" "),t.info?a("el-row",[a("el-col",{staticClass:"article",staticStyle:{"padding-right":"40px"},attrs:{span:18}},[a("div",{staticClass:"router"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:"/"}},[t._v("首页")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:"/project"}},[t._v("项目")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:"/project/"+t.info.branch.value}},[t._v(t._s(t.info.branch.name))]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:"/project/"+t.info.branch.value+"/"+t.info.category.value}},[t._v(t._s(t.info.category.name))]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.title))])],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"50px"},domProps:{innerHTML:t._s(t.info.html)}}),t._v(" "),a("el-row",[a("el-col",{staticStyle:{"text-align":"center","padding-bottom":"20px"}},[a("span",{staticClass:"thumb-button",class:t.info.praise?"active":"",attrs:{title:"点赞"},on:{click:t.setThumbs}},[a("i",{staticClass:"iconfont icon-zan"}),t._v(" "),t.info.praise?t._e():a("span",[t._v("点赞")]),t._v(" "),t.info.praise?a("span",[t._v("取消")]):t._e()])]),t._v(" "),a("el-col",{staticStyle:{"text-align":"center","margin-bottom":"40px",background:"#f5f5f5",padding:"3px 0"}},[t._l(t.info.praiselist.data,function(e,n){return a("router-link",{key:n,staticClass:"raise",attrs:{to:""}},[a("span",{staticClass:"cover"},[a("img",{attrs:{src:t.file+e.cover,alt:""}})]),t._v(" "),a("b",[t._v(t._s(e.name))])])}),t._v(" "),a("span",{staticStyle:{display:"inline-block","vertical-align":"middle","font-size":"14px",color:"#666"}},[t._v("等"),a("span",{staticStyle:{color:"#D94447","font-size":"18px",margin:"0 5px"}},[t._v(t._s(t.info.praiselist.total))]),t._v("人觉得很赞！")])],2)],1),t._v(" "),a("h3",{staticClass:"title"},[t._v("评论 "),a("span",{staticClass:"count"},[a("i",[t._v(t._s(t.total))]),t._v("条评论")])]),t._v(" "),t.comments.length?a("ul",{staticClass:"comments"},t._l(t.comments,function(e,n){return a("li",{key:n},[a("div",{staticClass:"comment-item"},[a("h2",[e.from?a("router-link",{attrs:{to:"/user/"+e.from.uId}},[a("img",{attrs:{src:t.file+e.from.cover,alt:""}}),t._v(" "),a("span",[t._v(t._s(e.from.name))])]):t._e(),t._v(" "),a("span",[t._v("于")]),t._v(" "),a("span",[t._v(t._s(t.gettime(e.created_at)))]),t._v(" "),a("span",[t._v("评论：")]),t._v(" "),e.to?a("span",[a("img",{attrs:{src:t.file+e.to.cover,alt:""}}),t._v(" "),a("span",[t._v(t._s(e.to.name))])]):t._e(),t._v(" "),a("i",{staticClass:"time"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.reback(e)}}},[t._v("回复("+t._s(e.children.length)+")")])],1)],1),t._v(" "),a("p",[t._v(t._s(e.content))])]),t._v(" "),e.children?a("ul",{staticClass:"sub"},t._l(e.children,function(n,s){return a("li",{key:s},[a("div",{staticClass:"comment-item"},[a("h2",[a("router-link",{staticClass:"v-m",attrs:{to:"/user/"+n.from.uId}},[t._v(t._s(n.from.name))]),t._v(" "),a("span",[t._v("回复")]),t._v(" "),a("router-link",{staticClass:"v-m",attrs:{to:"/user/"+n.to.uId}},[t._v(t._s(n.to.name))]),t._v(" "),a("span",{staticStyle:{"margin-left":"1em"}},[t._v(t._s(t.gettime(n.created_at)))]),t._v(" "),a("i",{staticClass:"time"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.rebacks(e,n)}}},[t._v("回复")])],1)],1),t._v(" "),a("p",[t._v(t._s(n.content))])])])})):t._e(),t._v(" "),e.reply?a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"回复"+e.from.name},model:{value:t.reply.content,callback:function(e){t.$set(t.reply,"content",e)},expression:"reply.content"}}):t._e()],1)})):t._e(),t._v(" "),!t.comments.length&&t.userInfo?a("empty",[a("img",{attrs:{slot:"icon",src:"static/tip1.png",alt:""},slot:"icon"}),t._v(" "),a("span",{attrs:{slot:"text"},slot:"text"},[t._v("还没有任何评论，快来抢沙发！")])]):t._e(),t._v(" "),t.userInfo?t._e():a("empty",[a("img",{attrs:{slot:"icon",src:"static/tip1.png",alt:""},slot:"icon"}),t._v(" "),a("span",{attrs:{slot:"text"},slot:"text"},[t._v("还没有任何评论，快来抢沙发！"),a("router-link",{attrs:{to:"/login?prev="+t.route.path}},[t._v("前往登录！")])],1)]),t._v(" "),t.userInfo?a("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"textarea",rows:4,placeholder:t.reply.parentId?"回复："+t.rebacker.from.name:"评论内容"},model:{value:t.reply.content,callback:function(e){t.$set(t.reply,"content",e)},expression:"reply.content"}}):t._e(),t._v(" "),t.userInfo?a("el-button",{attrs:{type:"primary"},domProps:{textContent:t._s(t.reply.parentId?"回复":"评论")},on:{click:t.submit}}):t._e()],1),t._v(" "),a("el-col",{staticClass:"article-info",attrs:{span:6}},[a("h2",{staticClass:"title"},[t._v("详情")]),t._v(" "),a("el-form",{staticStyle:{"margin-bottom":"20px"}},[a("el-form-item",{attrs:{label:"标题："}},[t._v("\n          "+t._s(t.info.title)+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"分类："}},[t._v("\n          "+t._s(t.info.branch.name)+">"+t._s(t.info.category.name)+"\n        ")]),t._v(" "),t.info.tag?a("el-form-item",{attrs:{label:"标签："}},t._l(t.info.tag.split(","),function(e,n){return a("el-tag",{key:n,staticStyle:{"margin-right":"5px"},attrs:{size:"mini"}},[t._v(t._s(e))])})):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"作者："}},[t._v("\n          "+t._s(t.info.author.name)+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"发布时间："}},[t._v("\n          "+t._s(t.gettime(t.info.created_at))+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"修改时间："}},[t._v("\n          "+t._s(t.gettime(t.info.updated_at))+"\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"浏览量："}},[t._v("\n          "+t._s(t.info.view)+"次\n        ")]),t._v(" "),a("el-form-item",{attrs:{label:"下载量："}},[t._v("\n          "+t._s(t.info.download)+"次\n        ")]),t._v(" "),t.info.attach?a("el-form-item",[t._l(t.info.attach,function(e,n){return a("el-button",{key:n,staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{type:"primary",round:""},on:{click:function(a){t.down(e)}}},[t._v("下载附件")])}),t._v(" "),a("span"),t._v(" "),t.info.collection?t._e():a("el-button",{staticStyle:{width:"100%","margin-bottom":"50px"},attrs:{type:"danger",round:""},on:{click:t.addCollection}},[t._v("收藏")]),t._v(" "),t.info.collection?a("el-button",{staticStyle:{width:"100%","margin-bottom":"50px"},attrs:{plain:"",type:"danger",round:""},on:{click:t.addCollection}},[t._v("取消收藏")]):t._e()],2):t._e()],1),t._v(" "),a("h2",{staticClass:"title"},[t._v("最受欢迎")]),t._v(" "),a("ul",{staticClass:"list"},t._l(t.info.related,function(e,n){return a("li",{key:n},[a("router-link",{attrs:{to:"/project/"+e.branch+"/"+e.category+"/"+e.uId}},[a("i",{staticClass:"tag"},[t._v(t._s(n+1))]),t._v(t._s(e.title))]),t._v(" "),a("span",[t._v(t._s(t.moment(1e3*parseInt(e.updated_at)).startOf("hour").fromNow()))])],1)}))],1)],1):t._e()],1)},staticRenderFns:[]};var _=a("VU/8")(m,u,!1,function(t){a("W7VF")},null,null);e.default=_.exports}});
//# sourceMappingURL=7.57b8cdbb99bed1ce6914.js.map